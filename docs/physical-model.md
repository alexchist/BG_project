# Физическая модель — Tinder-подобное приложение


---

## 1. Таблица `USER`

| **Название**   | **Описание**               | **Тип данных**   | **Ограничения**                                         |
|----------------|----------------------------|------------------|---------------------------------------------------------|
| user_id        | ID пользователя           | INT              | PK                                      |
| name           | Имя                       | VARCHAR(100)     | NOT NULL                                               |
| email          | Электронная почта         | VARCHAR(255)     | NOT NULL, UNIQUE                                       |
| password_hash  | Хэш пароля                | VARCHAR(255)     | NOT NULL                                               |
| gender         | Пол                       | CHAR(1)          | NOT NULL, CHECK (gender IN ('M','F','O'))              |
| birth_date     | Дата рождения             | DATE             | NOT NULL                                               |
| bio            | Описание / биография      | TEXT             |                                                       |
| location       | Местоположение            | VARCHAR(255)     |                                                       |

---

## 2. Таблица `PROFILE_PHOTO`

| **Название** | **Описание**                          | **Тип данных** | **Ограничения**                                         |
|--------------|---------------------------------------|----------------|---------------------------------------------------------|
| photo_id     | ID фотографии                         | INT            | PK                                      |
| user_id      | Ссылка на пользователя                | INT            | FK                          |
| photo_url    | Путь/URL к файлу фотографии           | VARCHAR(255)   | NOT NULL                                               |
| is_main      | Основная фотография (да/нет)          | BOOLEAN        | NOT NULL, DEFAULT FALSE                                |
| uploaded_at  | Дата/время загрузки                   | TIMESTAMP      | NOT NULL, DEFAULT CURRENT_TIMESTAMP                    |

---

## 3. Таблица `SWIPE`

| **Название** | **Описание**                        | **Тип данных** | **Ограничения**                                               |
|--------------|-------------------------------------|----------------|----------------------------------------------------------------|
| swipe_id     | ID свайпа                           | INT            | PK                                            |
| swiper_id    | Пользователь, совершающий свайп     | INT            |  FK                                  |
| target_id    | Пользователь, которого свайпят      | INT            | FK                                  |
| swipe_type   | Тип (like/dislike)                  | VARCHAR(10)    | NOT NULL, CHECK (swipe_type IN ('like','dislike'))            |
| swipe_time   | Дата/время свайпа                   | TIMESTAMP      | NOT NULL, DEFAULT CURRENT_TIMESTAMP                           |

---

## 4. Таблица `MATCH`

| **Название** | **Описание**                        | **Тип данных** | **Ограничения**                                             |
|--------------|-------------------------------------|----------------|--------------------------------------------------------------|
| match_id     | ID совпадения                       | INT            | PK                                          |
| swipe_id     | ID свайпа                     | INT            | FK
| user1_id     | Первый пользователь                 | INT            | NOT NULL                               |
| user2_id     | Второй пользователь                 | INT            | NOT NULL, CHECK (user1_id <> user2_id)  |
| matched_at   | Дата/время образования совпадения   | TIMESTAMP      | NOT NULL, DEFAULT CURRENT_TIMESTAMP                         |

---

## 5. Таблица `MESSAGE`

| **Название** | **Описание**                               | **Тип данных** | **Ограничения**                                  |
|--------------|--------------------------------------------|----------------|--------------------------------------------------|
| message_id   | ID сообщения                               | INT            | PK                               |
| match_id     | Ссылка на совпадение (MATCH)               | INT            |  FK                   |
| sender_id    | Отправитель сообщения (пользователь)       | INT            | FK                     |
| text         | Текст сообщения                            | TEXT           | NOT NULL                                         |
| sent_at      | Дата/время отправки                        | TIMESTAMP      | NOT NULL, DEFAULT CURRENT_TIMESTAMP             |

---

## 6. Таблица `PREFERENCE` (SCD Type 2)

| **Название**      | **Описание**                                 | **Тип данных** | **Ограничения**                                             |
|-------------------|----------------------------------------------|----------------|--------------------------------------------------------------|
| preference_id     | ID записи предпочтений                       | INT            | PK                                          |
| user_id           | Ссылка на пользователя                       | INT            | FK                              |
| preffered_gender           | Предпочтительный пол                       | CHAR(1)            |       NOT NULL, CHECK (gender IN ('M','F','O')) |
| age_min           | Минимальный возраст партнёра                | INT            | NOT NULL                                                    |
| age_max           | Максимальный возраст партнёра               | INT            | NOT NULL                                                    |
| distance_km       | Максимальное расстояние                      | INT            | NOT NULL                                                    |
| valid_from        | Дата/время начала действия этой версии       | TIMESTAMP      | NOT NULL                                                    |
| valid_to          | Дата/время окончания действия (NULL, если актуальная) | TIMESTAMP      | NULL                                                         |
| is_current        | Флаг, указывающий, является ли версия текущей| BOOLEAN        | NOT NULL                                                    |

---

